```markdown
#### File Monitoring System 

Система для отслеживания изменений файлов с ведением сессий работы пользователей. Мониторит изменения файлов, отслеживает кто и когда работал с файлами, сохраняет историю изменений.

#### Особенности

- **Мониторинг в реальном времени** - отслеживание изменений файлов
- **Система сессий** - учет времени работы пользователей с файлами
- **Умное возобновление** - продолжение сессий после коротких перерывов
- **Поддержка многих форматов** - Python, документы, чертежи, PDF и другие
- **Фильтрация временных файлов** - игнорирование служебных файлов редакторов
- **REST API** - полное API для интеграции с другими системами
- **Docker поддержка** - легкий запуск в контейнерах

#### Запуск проекта

#### Предварительные требования

- Docker и Docker Compose
- Python 3.8+
- Git

#### Начало работы

Следуйте этим шагам для первоначальной настройки и запуска проекта.


#### 1. Запуск базы данных PostgreSQL

```bash
docker-compose up -d postgres
```

Проверьте, что контейнер запущен:

```bash
docker ps
```

#### 2. Запуск сервиса сессий

Перейдите в директорию сервиса сессий:

```bash
cd session_service
```

#### 3. Создание виртуального окружения

```bash
# Для Windows:
python -m venv venv
venv\Scripts\activate

# Для Linux/MacOS:
python3 -m venv venv
source venv/bin/activate
```

#### 4. Установка зависимостей

```bash
pip install -r requirements.txt
```


#### 5. Запуск сервера

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

#### 6. Запуск системы мониторинга

В новом терминале перейдите в директорию мониторинга:

```bash
cd monitoring_agent
```

Запустите агент мониторинга:

```bash
python app/main.py
```

### Проверка работы

После запуска всех компонентов:
- Основной сервер будет доступен по адресу: `http://localhost:8000`
- API документация доступна по адресу: `http://localhost:8000/docs`

## Структура проекта

- `session_service/` - Основной сервис для управления сессиями и API
- `monitoring_agent/` - Агент мониторинга изменений файлов
- `app/main.py` - Точка входа для обоих сервисов

## Устранение неполадок

### Проблемы с подключением к базе данных

Если возникают проблемы с подключением к базе данных, проверьте:

1. Контейнер PostgreSQL запущен:
   ```bash
   docker ps
   ```

2. Настройки базы данных в конфигурации соответствуют вашей установке PostgreSQL

3. При необходимости перезапустите контейнер PostgreSQL:
   ```bash
   docker-compose restart postgres
   ```

### Проблемы с мониторингом файлов

Если мониторинг файлов не работает, убедитесь что:

1. Агент мониторинга имеет права на чтение отслеживаемых директорий
2. Конфигурация путей мониторинга указана корректно
3. Сервис сессий доступен по указанному адресу

## Разработка

### Запуск тестов

```bash
pytest
```

### Создание миграций базы данных

После изменения моделей:

```bash
python manage.py makemigrations
python manage.py migrate
```

### Остановка системы

1. **Остановка агента мониторинга**: `Ctrl+C` в терминале с агентом
2. **Остановка основного сервера**: `Ctrl+C` в терминале с сервером
3. **Остановка базы данных**:
   ```bash
   docker-compose down
   ```
```